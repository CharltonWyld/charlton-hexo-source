<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux常用操作</title>
      <link href="/2021/05/12/Linux%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/"/>
      <url>/2021/05/12/Linux%E5%B8%B8%E7%94%A8%E6%93%8D%E4%BD%9C/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h4><p>记录一下工作中用到过的Linux操作。</p><h4 id="查看日志"><a href="#查看日志" class="headerlink" title="查看日志"></a>查看日志</h4><ol><li><p>tail </p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 实时监控日志</span></span><br><span class="line">tail -f 文件名</span><br><span class="line">如：tail -f info.log</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看日志尾部最后10行日志</span></span><br><span class="line">tail -n 10 stdout.log</span><br></pre></td></tr></table></figure></li><li><p>grep</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep &quot;要搜索的内容&quot; 文件名</span><br></pre></td></tr></table></figure></li></ol><h4 id="查看文件"><a href="#查看文件" class="headerlink" title="查看文件"></a>查看文件</h4><ol><li><p>vim</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">vim 文件名</span><br><span class="line"><span class="meta">#</span><span class="bash"> 进入编辑模式</span></span><br><span class="line">1. i在光标处编辑</span><br><span class="line">2. A在当前行末尾编辑</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 命令模式</span></span><br><span class="line">查找： /  </span><br><span class="line">下一个： n</span><br><span class="line">上一个： N</span><br></pre></td></tr></table></figure></li><li><p>less</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1. less 文件名</span><br><span class="line">2. less -Nm 文件名 (可以显示 百分比和行号)</span><br><span class="line">3. 退出 q</span><br></pre></td></tr></table></figure></li></ol><h4 id="翻页"><a href="#翻页" class="headerlink" title="翻页"></a>翻页</h4><h5 id="翻整页"><a href="#翻整页" class="headerlink" title="翻整页"></a>翻整页</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下一页</span></span><br><span class="line">control + f  (f就是forword)</span><br><span class="line">或者直接 f/空格</span><br><span class="line"><span class="meta">#</span><span class="bash"> 上一页</span></span><br><span class="line">control + b  (b就是backward)</span><br><span class="line">或者直接 b</span><br></pre></td></tr></table></figure><h5 id="翻半页"><a href="#翻半页" class="headerlink" title="翻半页"></a>翻半页</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 向下翻半页</span></span><br><span class="line">control + d （d = down）</span><br><span class="line">或者直接 d</span><br><span class="line"><span class="meta">#</span><span class="bash"> 向上翻半页</span></span><br><span class="line">control + u  (u = up)</span><br><span class="line">或者直接 u</span><br></pre></td></tr></table></figure><h5 id="滚一行"><a href="#滚一行" class="headerlink" title="滚一行"></a>滚一行</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 第一种（正在用）</span></span><br><span class="line">j/k</span><br><span class="line"><span class="meta">#</span><span class="bash"> 第二种 (记不住)</span></span><br><span class="line">control + e</span><br><span class="line">control + y</span><br></pre></td></tr></table></figure><h4 id="压缩"><a href="#压缩" class="headerlink" title="压缩"></a>压缩</h4><h5 id="zip-压缩-unzip-解压"><a href="#zip-压缩-unzip-解压" class="headerlink" title="zip 压缩/ unzip 解压"></a>zip 压缩/ unzip 解压</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 将 aaa 目录中的内容压缩成aaa.zip，目录可以是相对路径 -r代表递归</span></span><br><span class="line">zip -r aaa.zip /Users/didi/Downloads/ChromeDownload/aaa/</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">unzip xxx.zip</span><br></pre></td></tr></table></figure><h5 id="tar压缩"><a href="#tar压缩" class="headerlink" title="tar压缩"></a>tar压缩</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">tar -zxvf test.tar.gz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 压缩</span></span><br><span class="line">tar -zcvf  test.tar.gz file1 file2</span><br></pre></td></tr></table></figure><h5 id="7z压缩"><a href="#7z压缩" class="headerlink" title="7z压缩"></a>7z压缩</h5><p>它的压缩比率比较高，如果文件数量较大为了节省空间 可以使用这种压缩方式</p><h6 id="安装7z"><a href="#安装7z" class="headerlink" title="安装7z"></a>安装7z</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> mac 安装</span></span><br><span class="line">brew install p7zip</span><br></pre></td></tr></table></figure><h6 id="压缩-解压"><a href="#压缩-解压" class="headerlink" title="压缩/解压"></a>压缩/解压</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 压缩</span></span><br><span class="line">7z a -t7z -r test.7z *.mp4 -mx=9</span><br><span class="line"><span class="meta">#</span><span class="bash"> 参数解释</span></span><br><span class="line">a：表示add命令，即新建一个压缩文件，该压缩文件存放在当前目录下</span><br><span class="line">-t7z 压缩文件的格式为7z(压缩zip则为-tzip)</span><br><span class="line">-r：表示遍历所有的子目录，每个文件都执行压缩操作，添加到压缩文件中</span><br><span class="line">-mx：表示压缩等级，9级是最高等级。默认等级是5。</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">7z x test.7z</span><br></pre></td></tr></table></figure><h4 id="查看服务是否启动"><a href="#查看服务是否启动" class="headerlink" title="查看服务是否启动"></a>查看服务是否启动</h4><h5 id="java服务"><a href="#java服务" class="headerlink" title="java服务"></a>java服务</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> jps 命令</span></span><br><span class="line">[root@localhost ~]# jps</span><br><span class="line">31779 xxxApplication</span><br><span class="line">5427 Elasticsearch</span><br><span class="line">24878 Jps</span><br></pre></td></tr></table></figure><h5 id="其他服务"><a href="#其他服务" class="headerlink" title="其他服务"></a>其他服务</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> ps aux | grep 项目关键词</span></span><br><span class="line">[root@localhost ~]# ps aux | grep media-server-standalone</span><br><span class="line">root     12828  0.0  0.0 669156  3860 ?        Sl   1月31   0:25 ./media-server-standalone</span><br><span class="line">root     25030  0.0  0.0 112724   988 pts/1    R+   15:59   0:00 grep --color=auto media-server-standalone</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者 ps -ef | grep media-server-standalone</span></span><br><span class="line">[root@localhost ~]# ps -ef | grep media-server-standalone</span><br><span class="line">root     12828  3788  0 1月31 ?       00:00:25 ./media-server-standalone</span><br><span class="line">root     25462 24837  0 16:04 pts/1    00:00:00 grep --color=auto media-server-standalone</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 可以加 grep -v grep 排除grep本身</span></span><br><span class="line">ps aux | grep media-server-standalone | grep -v grep</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 使用 lsof -i:8080 查看该端口有没有启起来</span></span><br><span class="line">[root@localhost ~]# lsof -i:8080</span><br><span class="line">COMMAND   PID USER   FD   TYPE   DEVICE SIZE/OFF NODE NAME</span><br><span class="line">java    31779 root  208u  IPv4 12627728      0t0  TCP *:webcache (LISTEN)</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> netstat -tunlp|grep 8080</span></span><br><span class="line">[root@localhost ~]# netstat -tunlp|grep 8080</span><br><span class="line">tcp        0      0 0.0.0.0:8080            0.0.0.0:*               LISTEN      31779/java </span><br></pre></td></tr></table></figure><h4 id="kill掉服务"><a href="#kill掉服务" class="headerlink" title="kill掉服务"></a>kill掉服务</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">kill -9 pid</span><br><span class="line">或者</span><br><span class="line">killall -9 media-server-standalone</span><br></pre></td></tr></table></figure><h4 id="nohup后台启动"><a href="#nohup后台启动" class="headerlink" title="nohup后台启动"></a>nohup后台启动</h4><h5 id="启动一个go服务"><a href="#启动一个go服务" class="headerlink" title="启动一个go服务"></a>启动一个go服务</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nohup ./media-server-standalone &gt;/dev/null 2&gt;nohup.out &amp;</span><br></pre></td></tr></table></figure><h5 id="启动一个脚本"><a href="#启动一个脚本" class="headerlink" title="启动一个脚本"></a>启动一个脚本</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动看门狗</span></span><br><span class="line">nohup sh watchdog.sh &gt;&gt; watchdog.log 2&gt;&amp;1 &amp;</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 看门狗</span></span><br><span class="line">[root@localhost media-server-standalone]# cat watchdog.sh </span><br><span class="line">while true;</span><br><span class="line">do</span><br><span class="line">    time1=$(date)</span><br><span class="line">    echo $time1</span><br><span class="line">    count=`ps -ef | grep media-server-standalone | grep -v grep`</span><br><span class="line">    if [ &quot;$?&quot; != &quot;0&quot; ];then</span><br><span class="line">        echo  &quot;&gt;&gt;&gt;&gt;no media-server-standalone,run it&quot;</span><br><span class="line">        echo  &quot;&gt;&gt;&gt;&gt;restart media-server-standalone now !&quot;</span><br><span class="line">        nohup ./media-server-standalone &gt;/dev/null 2&gt;nohup.out &amp;</span><br><span class="line">    else</span><br><span class="line">        echo &quot;&gt;&gt;&gt;&gt;media-server-standalone is runing...&quot;</span><br><span class="line">    fi</span><br><span class="line">    sleep 60</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="启动ES"><a href="#启动ES" class="headerlink" title="启动ES"></a>启动ES</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动 es （需切换到es用户）</span></span><br><span class="line">./elasticsearch -d</span><br></pre></td></tr></table></figure><h5 id="启动kibana"><a href="#启动kibana" class="headerlink" title="启动kibana"></a>启动kibana</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 启动kibana （需切换到es用户）</span></span><br><span class="line">nohup ./bin/kibana &gt;&gt; kibana.log 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><h5 id="nohup用法"><a href="#nohup用法" class="headerlink" title="nohup用法"></a>nohup用法</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 只输出错误信息到日志文件</span></span><br><span class="line">nohup ./program &gt;/dev/null 2&gt;log &amp;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 什么信息也不要</span></span><br><span class="line">nohup ./program &gt;/dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure><h4 id="磁盘使用情况"><a href="#磁盘使用情况" class="headerlink" title="磁盘使用情况"></a>磁盘使用情况</h4><h5 id="查看文件大小"><a href="#查看文件大小" class="headerlink" title="查看文件大小"></a>查看文件大小</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> df -h</span></span><br><span class="line">[root@localhost ~]# df -h</span><br><span class="line">文件系统                 容量  已用  可用 已用% 挂载点</span><br><span class="line">/dev/mapper/centos-root   50G   23G   28G   46% /</span><br><span class="line">devtmpfs                  16G     0   16G    0% /dev</span><br><span class="line">tmpfs                     16G     0   16G    0% /dev/shm</span><br><span class="line">tmpfs                     16G  234M   16G    2% /run</span><br><span class="line">tmpfs                     16G     0   16G    0% /sys/fs/cgroup</span><br><span class="line">/dev/md126p2            1014M  164M  851M   17% /boot</span><br><span class="line">/dev/md126p1             200M  9.8M  191M    5% /boot/efi</span><br><span class="line">/dev/mapper/centos-home  3.4T  233G  3.2T    7% /home</span><br><span class="line">tmpfs                    3.2G     0  3.2G    0% /run/user/0</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> du -h --max-depth=1</span></span><br><span class="line">[root@localhost ~]# du -h --max-depth=1</span><br><span class="line">12M./.cache</span><br><span class="line">4.0K./.dbus</span><br><span class="line">0./.config</span><br><span class="line">4.3G./work</span><br><span class="line">196K./firmware</span><br><span class="line">112K./data1</span><br><span class="line">4.3G.</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> du -sh *</span></span><br><span class="line">[root@localhost output]# du -sh *</span><br><span class="line">16Kbin</span><br><span class="line">20Kconf</span><br><span class="line">0Dockerfile</span><br><span class="line">4.0Kemptystdlog.sh</span><br><span class="line">28Mgc.log.2021-01-13_18_17_58</span><br><span class="line">61Mgc.log.2021-02-18_14_43_46</span><br><span class="line">75Mlib</span><br><span class="line">4.0Gstdout.log</span><br></pre></td></tr></table></figure><h5 id="在Linux上用U盘或移动硬盘拷贝数据"><a href="#在Linux上用U盘或移动硬盘拷贝数据" class="headerlink" title="在Linux上用U盘或移动硬盘拷贝数据"></a>在Linux上用U盘或移动硬盘拷贝数据</h5><ol><li><p><strong>通过 fdisk -l  找到自己的U盘</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">[root@localhost ~]# fdisk -l</span><br><span class="line">WARNING: fdisk GPT support is currently new, and therefore in an experimental phase. Use at your own discretion.</span><br><span class="line"></span><br><span class="line">磁盘 /dev/sda：4000.8 GB, 4000787030016 字节，7814037168 个扇区</span><br><span class="line">Units = 扇区 of 1 * 512 = 512 bytes</span><br><span class="line">扇区大小(逻辑/物理)：512 字节 / 512 字节</span><br><span class="line">I/O 大小(最小/最佳)：512 字节 / 512 字节</span><br><span class="line">磁盘标签类型：gpt</span><br><span class="line">Disk identifier: C45A17BF-A83E-422B-A363-A1A50D6D29F8</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">         Start          End    Size  Type            Name</span></span><br><span class="line"> 1         2048       411647    200M  EFI System      EFI System Partition</span><br><span class="line"> 2       411648      2508799      1G  Microsoft basic </span><br><span class="line"> 3      2508800   7423322111    3.5T  Linux LVM       </span><br><span class="line">WARNING: fdisk GPT support is currently new, and therefore in an experimental phase. Use at your own discretion.</span><br><span class="line"></span><br><span class="line">磁盘 /dev/sdb：4000.8 GB, 4000787030016 字节，7814037168 个扇区</span><br><span class="line">Units = 扇区 of 1 * 512 = 512 bytes</span><br><span class="line">扇区大小(逻辑/物理)：512 字节 / 512 字节</span><br><span class="line">I/O 大小(最小/最佳)：512 字节 / 512 字节</span><br><span class="line">磁盘标签类型：gpt</span><br><span class="line">Disk identifier: C45A17BF-A83E-422B-A363-A1A50D6D29F8</span><br></pre></td></tr></table></figure><p><strong>比如找到自己的U盘：/dev/sdc1</strong></p></li><li><p><strong>加载USB模块</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">modprobe usb-storage</span><br></pre></td></tr></table></figure></li><li><p>在 目录 /mnt 下创建 文件夹 usb_disk</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mkdir /mnt/usb_disk</span><br></pre></td></tr></table></figure></li><li><p>挂载U盘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 方式1</span></span><br><span class="line">mount /dev/sdc1 /mnt/usb_disk/</span><br><span class="line"><span class="meta">#</span><span class="bash"> 方式2</span></span><br><span class="line">mount -t ntfs /dev/sdc1 /mnt/usb_disk/</span><br></pre></td></tr></table></figure><p>如果有问题，需要下载 <code>ntfs-3g</code>，然后执行 <code>mount  -t ntfs-3g /dev/sdc1 /mnt/usb_disk/</code></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 下载</span></span><br><span class="line">wget https://tuxera.com/opensource/ntfs-3g_ntfsprogs-2017.3.23.tgz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 解压</span></span><br><span class="line">tar xf ntfs-3g_ntfsprogs-2017.3.23.tgz</span><br><span class="line"><span class="meta">#</span><span class="bash"> 目录位置</span></span><br><span class="line">/usr/local/ntfs-3g_ntfsprogs-2017.3.23</span><br><span class="line"><span class="meta">#</span><span class="bash"> 编译安装</span></span><br><span class="line">cd ntfs-3g_ntfsprogs-2017.3.23</span><br><span class="line">./configure &amp;&amp; echo $?</span><br><span class="line">make &amp;&amp; echo $?</span><br><span class="line">make install &amp;&amp; echo $?</span><br></pre></td></tr></table></figure></li><li><p>卸载U盘</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">umount /mnt/usb_disk/</span><br></pre></td></tr></table></figure></li></ol><h4 id="scp上传下载"><a href="#scp上传下载" class="headerlink" title="scp上传下载"></a>scp上传下载</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 本地上传文件到服务器</span></span><br><span class="line">scp test.7z root@192.168.41.211:/root/work</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 服务的文件 传到本地</span></span><br><span class="line">scp root@192.168.41.211:/root/work/test.7z ./</span><br></pre></td></tr></table></figure><h4 id="防火墙"><a href="#防火墙" class="headerlink" title="防火墙"></a>防火墙</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 查看 开通的端口</span></span><br><span class="line">firewall-cmd --zone=public --list-ports</span><br><span class="line"><span class="meta">#</span><span class="bash"> 开通某个端口（移除某个端口）</span></span><br><span class="line">firewall-cmd --zone=public --add-port=8080/tcp --permanent</span><br><span class="line">firewall-cmd --zone=public --remove-port=8080/tcp --permanent</span><br><span class="line"><span class="meta">#</span><span class="bash"> 重启防火墙</span></span><br><span class="line">firewall-cmd --reload</span><br></pre></td></tr></table></figure><h4 id="修改某个文件的用户和用户组"><a href="#修改某个文件的用户和用户组" class="headerlink" title="修改某个文件的用户和用户组"></a>修改某个文件的用户和用户组</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 对elk-es-cluster_server.json文件 设置用户和用户组分别为es和es</span></span><br><span class="line">chown es:es elk-es-cluster_server.json</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果 需要递归设置 加 -R 参数</span></span><br></pre></td></tr></table></figure><h4 id="查找指令"><a href="#查找指令" class="headerlink" title="查找指令"></a>查找指令</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">whereis java</span><br><span class="line">find / -name java</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Linux下定时清空某个文件</title>
      <link href="/2021/04/19/Linux%E4%B8%8B%E5%AE%9A%E6%97%B6%E6%B8%85%E7%A9%BA%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6/"/>
      <url>/2021/04/19/Linux%E4%B8%8B%E5%AE%9A%E6%97%B6%E6%B8%85%E7%A9%BA%E6%9F%90%E4%B8%AA%E6%96%87%E4%BB%B6/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h4 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h4><p>在一台单点机器部署完成且运行一段时间后，发现页面接口报错，登上机器发现磁盘满了。通过<code>du -lh --max-depth=1</code> 和 <code>du -sh *</code> 找出是哪个文件。</p><p>发现是 项目中 stdout.log 文件过大，已经增加到了30多个G。</p><h4 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h4><p>使用 <code>crontab</code>定时执行清空stdout.log文件的命令。</p><ol><li><p>准备一个 emptystdlog.sh 文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">touch emptystdlog.sh</span><br></pre></td></tr></table></figure></li><li><p>文件写入以下内容</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">echo &quot;&quot; &gt; /root/work/output/stdout.log;</span><br></pre></td></tr></table></figure></li><li><p>使用<code>crontab -e</code> 每天定时执行一次</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0 0 * * * /bin/bash -x /root/work/output/emptystdlog.sh &gt; /dev/null 2&gt;&amp;1</span><br></pre></td></tr></table></figure></li><li><p>查看 <code>crontab</code>使用情况</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontable -l</span><br></pre></td></tr></table></figure></li><li><p>编辑或删除定时任务</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontable -e</span><br></pre></td></tr></table></figure></li></ol><h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>这不是解决这个问题的好办法，应该通过设置 <code>logback-spring.xml</code> 文件来控制 stdout.log 文件</p>]]></content>
      
      
      <categories>
          
          <category> Linux </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Hello World</title>
      <link href="/2021/02/15/hello-world/"/>
      <url>/2021/02/15/hello-world/</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><p>Welcome to <a href="https://hexo.io/">Hexo</a>! This is your very first post. Check <a href="https://hexo.io/docs/">documentation</a> for more info. If you get any problems when using Hexo, you can find the answer in <a href="https://hexo.io/docs/troubleshooting.html">troubleshooting</a> or you can ask me on <a href="https://github.com/hexojs/hexo/issues">GitHub</a>.</p><h2 id="Quick-Start"><a href="#Quick-Start" class="headerlink" title="Quick Start"></a>Quick Start</h2><h3 id="Create-a-new-post"><a href="#Create-a-new-post" class="headerlink" title="Create a new post"></a>Create a new post</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo new <span class="string">&quot;My New Post&quot;</span></span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/writing.html">Writing</a></p><h3 id="Run-server"><a href="#Run-server" class="headerlink" title="Run server"></a>Run server</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo server</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/server.html">Server</a></p><h3 id="Generate-static-files"><a href="#Generate-static-files" class="headerlink" title="Generate static files"></a>Generate static files</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo generate</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/generating.html">Generating</a></p><h3 id="Deploy-to-remote-sites"><a href="#Deploy-to-remote-sites" class="headerlink" title="Deploy to remote sites"></a>Deploy to remote sites</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ hexo deploy</span><br></pre></td></tr></table></figure><p>More info: <a href="https://hexo.io/docs/one-command-deployment.html">Deployment</a></p>]]></content>
      
      
      
    </entry>
    
    
  
  
</search>
